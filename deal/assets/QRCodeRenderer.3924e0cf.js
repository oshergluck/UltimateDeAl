import{cK as X,cL as b,cN as S,cM as G}from"./index.a890a1de.js";var A=(s=>(s[s.Border=-1]="Border",s[s.Data=0]="Data",s[s.Function=1]="Function",s[s.Position=2]="Position",s[s.Timing=3]="Timing",s[s.Alignment=4]="Alignment",s))(A||{}),K=Object.defineProperty,H=(s,t,e)=>t in s?K(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,z=(s,t,e)=>(H(s,typeof t!="symbol"?t+"":t,e),e);const W=[0,1],x=[1,0],L=[2,3],U=[3,2],Z={L:W,M:x,Q:L,H:U},J=/^[0-9]*$/,j=/^[A-Z0-9 $%*+.\/:-]*$/,_="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",v=1,B=40,O=3,Q=3,R=40,tt=10,$=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],D=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class et{constructor(t,e,n,o){if(this.version=t,this.ecc=e,z(this,"size"),z(this,"mask"),z(this,"modules",[]),z(this,"types",[]),t<v||t>B)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=t*4+17;const r=Array.from({length:this.size},()=>!1);for(let l=0;l<this.size;l++)this.modules.push(r.slice()),this.types.push(r.map(()=>0));this.drawFunctionPatterns();const i=this.addEccAndInterleave(n);if(this.drawCodewords(i),o===-1){let l=1e9;for(let c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);const h=this.getPenaltyScore();h<l&&(o=c,l=h),this.applyMask(c)}}this.mask=o,this.applyMask(o),this.drawFormatBits(o)}getModule(t,e){return t>=0&&t<this.size&&e>=0&&e<this.size&&this.modules[e][t]}drawFunctionPatterns(){for(let n=0;n<this.size;n++)this.setFunctionModule(6,n,n%2===0,A.Timing),this.setFunctionModule(n,6,n%2===0,A.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),e=t.length;for(let n=0;n<e;n++)for(let o=0;o<e;o++)n===0&&o===0||n===0&&o===e-1||n===e-1&&o===0||this.drawAlignmentPattern(t[n],t[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const e=this.ecc[1]<<3|t;let n=e;for(let r=0;r<10;r++)n=n<<1^(n>>>9)*1335;const o=(e<<10|n)^21522;for(let r=0;r<=5;r++)this.setFunctionModule(8,r,M(o,r));this.setFunctionModule(8,7,M(o,6)),this.setFunctionModule(8,8,M(o,7)),this.setFunctionModule(7,8,M(o,8));for(let r=9;r<15;r++)this.setFunctionModule(14-r,8,M(o,r));for(let r=0;r<8;r++)this.setFunctionModule(this.size-1-r,8,M(o,r));for(let r=8;r<15;r++)this.setFunctionModule(8,this.size-15+r,M(o,r));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let n=0;n<12;n++)t=t<<1^(t>>>11)*7973;const e=this.version<<12|t;for(let n=0;n<18;n++){const o=M(e,n),r=this.size-11+n%3,i=Math.floor(n/3);this.setFunctionModule(r,i,o),this.setFunctionModule(i,r,o)}}drawFinderPattern(t,e){for(let n=-4;n<=4;n++)for(let o=-4;o<=4;o++){const r=Math.max(Math.abs(o),Math.abs(n)),i=t+o,l=e+n;i>=0&&i<this.size&&l>=0&&l<this.size&&this.setFunctionModule(i,l,r!==2&&r!==4,A.Position)}}drawAlignmentPattern(t,e){for(let n=-2;n<=2;n++)for(let o=-2;o<=2;o++)this.setFunctionModule(t+o,e+n,Math.max(Math.abs(o),Math.abs(n))!==1,A.Alignment)}setFunctionModule(t,e,n,o=A.Function){this.modules[e][t]=n,this.types[e][t]=o}addEccAndInterleave(t){const e=this.version,n=this.ecc;if(t.length!==F(e,n))throw new RangeError("Invalid argument");const o=D[n[0]][e],r=$[n[0]][e],i=Math.floor(N(e)/8),l=o-i%o,c=Math.floor(i/o),h=[],f=ht(r);for(let u=0,p=0;u<o;u++){const w=t.slice(p,p+c-r+(u<l?0:1));p+=w.length;const P=ft(w,f);u<l&&w.push(0),h.push(w.concat(P))}const a=[];for(let u=0;u<h[0].length;u++)h.forEach((p,w)=>{(u!==c-r||w>=l)&&a.push(p[u])});return a}drawCodewords(t){if(t.length!==Math.floor(N(this.version)/8))throw new RangeError("Invalid argument");let e=0;for(let n=this.size-1;n>=1;n-=2){n===6&&(n=5);for(let o=0;o<this.size;o++)for(let r=0;r<2;r++){const i=n-r,c=(n+1&2)===0?this.size-1-o:o;!this.types[c][i]&&e<t.length*8&&(this.modules[c][i]=M(t[e>>>3],7-(e&7)),e++)}}}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let e=0;e<this.size;e++)for(let n=0;n<this.size;n++){let o;switch(t){case 0:o=(n+e)%2===0;break;case 1:o=e%2===0;break;case 2:o=n%3===0;break;case 3:o=(n+e)%3===0;break;case 4:o=(Math.floor(n/3)+Math.floor(e/2))%2===0;break;case 5:o=n*e%2+n*e%3===0;break;case 6:o=(n*e%2+n*e%3)%2===0;break;case 7:o=((n+e)%2+n*e%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[e][n]&&o&&(this.modules[e][n]=!this.modules[e][n])}}getPenaltyScore(){let t=0;for(let r=0;r<this.size;r++){let i=!1,l=0;const c=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[r][h]===i?(l++,l===5?t+=O:l>5&&t++):(this.finderPenaltyAddHistory(l,c),i||(t+=this.finderPenaltyCountPatterns(c)*R),i=this.modules[r][h],l=1);t+=this.finderPenaltyTerminateAndCount(i,l,c)*R}for(let r=0;r<this.size;r++){let i=!1,l=0;const c=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[h][r]===i?(l++,l===5?t+=O:l>5&&t++):(this.finderPenaltyAddHistory(l,c),i||(t+=this.finderPenaltyCountPatterns(c)*R),i=this.modules[h][r],l=1);t+=this.finderPenaltyTerminateAndCount(i,l,c)*R}for(let r=0;r<this.size-1;r++)for(let i=0;i<this.size-1;i++){const l=this.modules[r][i];l===this.modules[r][i+1]&&l===this.modules[r+1][i]&&l===this.modules[r+1][i+1]&&(t+=Q)}let e=0;for(const r of this.modules)e=r.reduce((i,l)=>i+(l?1:0),e);const n=this.size*this.size,o=Math.ceil(Math.abs(e*20-n*10)/n)-1;return t+=o*tt,t}getAlignmentPatternPositions(){if(this.version===1)return[];{const t=Math.floor(this.version/7)+2,e=this.version===32?26:Math.ceil((this.version*4+4)/(t*2-2))*2,n=[6];for(let o=this.size-7;n.length<t;o-=e)n.splice(1,0,o);return n}}finderPenaltyCountPatterns(t){const e=t[1],n=e>0&&t[2]===e&&t[3]===e*3&&t[4]===e&&t[5]===e;return(n&&t[0]>=e*4&&t[6]>=e?1:0)+(n&&t[6]>=e*4&&t[0]>=e?1:0)}finderPenaltyTerminateAndCount(t,e,n){return t&&(this.finderPenaltyAddHistory(e,n),e=0),e+=this.size,this.finderPenaltyAddHistory(e,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(t,e){e[0]===0&&(t+=this.size),e.pop(),e.unshift(t)}}function E(s,t,e){if(t<0||t>31||s>>>t!==0)throw new RangeError("Value out of range");for(let n=t-1;n>=0;n--)e.push(s>>>n&1)}function M(s,t){return(s>>>t&1)!==0}class I{constructor(t,e,n){if(this.mode=t,this.numChars=e,this.bitData=n,e<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}getData(){return this.bitData.slice()}}const nt=[1,10,12,14],st=[2,9,11,13],ot=[4,8,16,16];function T(s,t){return s[Math.floor((t+7)/17)+1]}function Y(s){const t=[];for(const e of s)E(e,8,t);return new I(ot,s.length,t)}function rt(s){if(!V(s))throw new RangeError("String contains non-numeric characters");const t=[];for(let e=0;e<s.length;){const n=Math.min(s.length-e,3);E(Number.parseInt(s.substring(e,e+n),10),n*3+1,t),e+=n}return new I(nt,s.length,t)}function it(s){if(!q(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");const t=[];let e;for(e=0;e+2<=s.length;e+=2){let n=_.indexOf(s.charAt(e))*45;n+=_.indexOf(s.charAt(e+1)),E(n,11,t)}return e<s.length&&E(_.indexOf(s.charAt(e)),6,t),new I(st,s.length,t)}function lt(s){return s===""?[]:V(s)?[rt(s)]:q(s)?[it(s)]:[Y(ct(s))]}function V(s){return J.test(s)}function q(s){return j.test(s)}function at(s,t){let e=0;for(const n of s){const o=T(n.mode,t);if(n.numChars>=1<<o)return Number.POSITIVE_INFINITY;e+=4+o+n.bitData.length}return e}function ct(s){s=encodeURI(s);const t=[];for(let e=0;e<s.length;e++)s.charAt(e)!=="%"?t.push(s.charCodeAt(e)):(t.push(Number.parseInt(s.substring(e+1,e+3),16)),e+=2);return t}function N(s){if(s<v||s>B)throw new RangeError("Version number out of range");let t=(16*s+128)*s+64;if(s>=2){const e=Math.floor(s/7)+2;t-=(25*e-10)*e-55,s>=7&&(t-=36)}return t}function F(s,t){return Math.floor(N(s)/8)-$[t[0]][s]*D[t[0]][s]}function ht(s){if(s<1||s>255)throw new RangeError("Degree out of range");const t=[];for(let n=0;n<s-1;n++)t.push(0);t.push(1);let e=1;for(let n=0;n<s;n++){for(let o=0;o<t.length;o++)t[o]=C(t[o],e),o+1<t.length&&(t[o]^=t[o+1]);e=C(e,2)}return t}function ft(s,t){const e=t.map(n=>0);for(const n of s){const o=n^e.shift();e.push(0),t.forEach((r,i)=>e[i]^=C(r,o))}return e}function C(s,t){if(s>>>8!==0||t>>>8!==0)throw new RangeError("Byte out of range");let e=0;for(let n=7;n>=0;n--)e=e<<1^(e>>>7)*285,e^=(t>>>n&1)*s;return e}function ut(s,t,e=1,n=40,o=-1,r=!0){if(!(v<=e&&e<=n&&n<=B)||o<-1||o>7)throw new RangeError("Invalid value");let i,l;for(i=e;;i++){const a=F(i,t)*8,u=at(s,i);if(u<=a){l=u;break}if(i>=n)throw new RangeError("Data too long")}for(const a of[x,L,U])r&&l<=F(i,a)*8&&(t=a);const c=[];for(const a of s){E(a.mode[0],4,c),E(a.numChars,T(a.mode,i),c);for(const u of a.getData())c.push(u)}const h=F(i,t)*8;E(0,Math.min(4,h-c.length),c),E(0,(8-c.length%8)%8,c);for(let a=236;c.length<h;a^=253)E(a,8,c);const f=Array.from({length:Math.ceil(c.length/8)},()=>0);return c.forEach((a,u)=>f[u>>>3]|=a<<7-(u&7)),new et(i,t,f,o)}function dt(s,t){const{ecc:e="L",boostEcc:n=!1,minVersion:o=1,maxVersion:r=40,maskPattern:i=-1,border:l=1}=t||{},c=typeof s=="string"?lt(s):Array.isArray(s)?[Y(s)]:void 0;if(!c)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof s}`);const h=ut(c,Z[e],o,r,i,n),f=gt({version:h.version,maskPattern:h.mask,size:h.size,data:h.modules,types:h.types},l);return t?.invert&&(f.data=f.data.map(a=>a.map(u=>!u))),t?.onEncoded?.(f),f}function gt(s,t=1){if(!t)return s;const{size:e}=s,n=e+t*2;s.size=n,s.data.forEach(r=>{for(let i=0;i<t;i++)r.unshift(!1),r.push(!1)});for(let r=0;r<t;r++)s.data.unshift(Array.from({length:n},i=>!1)),s.data.push(Array.from({length:n},i=>!1));const o=A.Border;s.types.forEach(r=>{for(let i=0;i<t;i++)r.unshift(o),r.push(o)});for(let r=0;r<t;r++)s.types.unshift(Array.from({length:n},i=>o)),s.types.push(Array.from({length:n},i=>o));return s}function wt({ecl:s="M",size:t=200,uri:e,clearSize:n=0,image:o,imageBackground:r="transparent"}){const i=n,l=t-10*2,c=X.exports.useMemo(()=>{const h=[],f=dt(e,{ecc:s,border:0}).data,a=l/f.length,u=[{x:0,y:0},{x:1,y:0},{x:0,y:1}];for(const{x:y,y:d}of u){const k=(f.length-7)*a*y,m=(f.length-7)*a*d;for(let g=0;g<3;g++)h.push(b("rect",{fill:g%2!==0?"var(--ck-qr-background, var(--ck-body-background))":"var(--ck-qr-dot-color)",rx:(g-2)*-5+(g===0?2:3),ry:(g-2)*-5+(g===0?2:3),width:a*(7-g*2),height:a*(7-g*2),x:k+a*g,y:m+a*g},`${g}-${y}-${d}`))}if(o){const y=(f.length-7)*a*1,d=(f.length-7)*a*1;h.push(S(G,{children:[b("rect",{fill:r,rx:(0-2)*-5+2,ry:(0-2)*-5+2,width:a*(7-0*2),height:a*(7-0*2),x:y+a*0,y:d+a*0}),b("foreignObject",{width:a*(7-0*2),height:a*(7-0*2),x:y+a*0,y:d+a*0,children:b("div",{style:{borderRadius:(0-2)*-5+2,overflow:"hidden"},children:o})})]}))}const p=Math.floor((i+25)/a),w=f.length/2-p/2,P=f.length/2+p/2-1;return f.forEach((y,d)=>{y.forEach((k,m)=>{f[d]?.[m]&&(d<7&&m<7||d>f.length-8&&m<7||d<7&&m>f.length-8||(o||!(d>w&&d<P&&m>w&&m<P))&&h.push(b("circle",{cx:d*a+a/2,cy:m*a+a/2,fill:"var(--ck-qr-dot-color)",r:a/3},`circle-${d}-${m}`)))})}),h},[s,o,r,i,l,e]);return S("svg",{height:l,width:l,viewBox:`0 0 ${l} ${l}`,style:{width:l,height:l},role:"presentation",children:[b("rect",{fill:"transparent",height:l,width:l}),c]})}export{wt as default};
